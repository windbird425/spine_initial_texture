window.__require=function e(t,n,i){function a(o,s){if(!n[o]){if(!t[o]){var c=o.split("/");if(c=c[c.length-1],!t[c]){var u="function"==typeof __require&&__require;if(!s&&u)return u(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+o+"'")}o=c}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){return a(t[o][1][e]||e)},h,h.exports,e,t,n,i)}return n[o].exports}for(var r="function"==typeof __require&&__require,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(e,t,n){n.endianness=function(){return"LE"},n.hostname=function(){return"undefined"!=typeof location?location.hostname:""},n.loadavg=function(){return[]},n.uptime=function(){return 0},n.freemem=function(){return Number.MAX_VALUE},n.totalmem=function(){return Number.MAX_VALUE},n.cpus=function(){return[]},n.type=function(){return"Browser"},n.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},n.networkInterfaces=n.getNetworkInterfaces=function(){return{}},n.arch=function(){return"javascript"},n.platform=function(){return"browser"},n.tmpdir=n.tmpDir=function(){return"/tmp"},n.EOL="\n"},{}],HelloWorld:[function(e,t){"use strict";cc._RF.push(t,"280c3rsZJJKnZ9RqbALVwtK","HelloWorld"),e("os").type;var n=cc.Enum({FunctionName:0,RegionName:1});cc.Class({extends:cc.Component,properties:{sampleButton:{default:null,type:cc.Node},regionButton:{default:null,type:cc.Node},downloadButton:{default:null,type:cc.Node},targetSpine:{default:null,type:sp.Skeleton},originSpine:{default:null,type:sp.Skeleton}},ctor:function(){this.changeParts=["DLJM_DL_02","DLJM_DZ_GunZi","DLJM_JB_02"],this.regionButtonNames=["\u71c8\u7c60","\u68cd\u5b50","\u91d1\u5e63"],this.changeSpriteFrames=null},onLoad:function(){cc.assetManager.loadBundle("ChangeTexture",function(e,t){t.loadDir("",cc.SpriteFrame,function(e,t){cc.log("\u8f09\u5b8c\u4e86"),cc.log(t),this.changeSpriteFrames=t,this.downloadButton.active=!0}.bind(this))}.bind(this))},_initSkinButton:function(){var e=this;Object.keys(this.targetSpine.skeletonData.skeletonJson.skins).forEach(function(t,n){var i=cc.instantiate(e.sampleButton),a=n%6,r=Math.floor(n/6);i.name=t,i.active=!0,i.x=i.x+150*a,i.y=i.y-50*r,i.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string=t,e.node.addChild(i)})},_initRegionButton:function(){var e=this;this.regionButtonNames.forEach(function(t,n){var i=cc.instantiate(e.regionButton),a=n%6,r=Math.floor(n/6);i.name="changeRegion@"+e.changeParts[n],i.active=!0,i.x=i.x+150*a,i.y=i.y-50*r,i.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string=t;var o=cc.instantiate(e.regionButton);o.name="recoverRegion@"+e.changeParts[n],o.active=!0,o.x=o.x+150*a,o.y=o.y-50*r,o.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string="\u9084\u539f"+t,e.node.addChild(i,2),e.node.addChild(o,1)})},_initRegionButton2:function(){var e=this;this.regionButtonNames.forEach(function(t,n){var i=cc.instantiate(e.regionButton),a=n%6,r=Math.floor(n/6);i.name="recoverRegion@"+e.changeParts[n],i.active=!0,i.x=i.x+150*a,i.y=i.y-50*r-(i.height+50),i.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string="\u9084\u539f"+t,e.node.addChild(i)})},_testChange:function(){for(var e=this,t=function(t){var n=e.targetSpine.findSlot(e.changeParts[t]),i=n.getAttachment();cc.log("test\uff1a",n);var a=e.changeParts[t],r=e.createRegionBySpriteFrame(e.changeSpriteFrames.find(function(e){return e.name==a}));"function"==typeof i.setRegion?(i.setRegion(r),i.updateOffset()):(i.region=r,i.updateUVs())},n=0;n<this.changeParts.length;n++)t(n)},createRegionBySpriteFrame:function(e){var t=e.getTexture();cc.log("createRegionBySpriteFrame\uff1a",t);var n=new sp.SkeletonTexture({width:t.width,height:t.height});n.setRealTexture(t);var i=new sp.spine.TextureAtlasPage;i.name=e.name,i.uWrap=sp.spine.TextureWrap.ClampToEdge,i.vWrap=sp.spine.TextureWrap.ClampToEdge,i.texture=n,i.texture.setWraps(i.uWrap,i.vWrap),i.width=t.width,i.height=t.height;var a=new sp.spine.TextureAtlasRegion;return a.page=i,a.name=e.name,a.width=e._rect.width,a.height=e._rect.height,a.x=e._rect.x,a.y=e._rect.y,a.originalWidth=e._rect.width,a.originalHeight=e._rect.height,a.rotate=e._rotated,a.u=e.uv[0],a.v=e.uv[7],a.u2=e.uv[6],a.v2=e.uv[1],a.texture=n,a},createRegionByRegion:function(e){var t=e.texture;cc.log("createRegionByRegion skeletonTexture\uff1a",t);var n=new sp.spine.TextureAtlasPage;n.name=e.name,n.uWrap=sp.spine.TextureWrap.ClampToEdge,n.vWrap=sp.spine.TextureWrap.ClampToEdge,n.texture=t,n.texture.setWraps(n.uWrap,n.vWrap),n.width=t._image.width,n.height=t._image.height;var i=new sp.spine.TextureAtlasRegion;return i.page=n,i.name=e.name,i.width=e.width,i.height=e.height,i.x=e.x,i.y=e.y,i.originalWidth=e.originalWidth,i.originalHeight=e.originalHeight,i.rotate=e.rotate,i.u=e.u,i.v=e.v,i.u2=e.u2,i.v2=e.v2,i.texture=t,i},onClickChangeSkin:function(e){var t=e.target.getChildByName("Background").getChildByName("Label").getComponent(cc.Label);this.targetSpine.setSkin(t.string),this.originSpine.setSkin(t.string)},onClickSwitchRegion:function(e){var t=e.target,i=t.name.split("@")[n.FunctionName],a=t.name.split("@")[n.RegionName];this["_"+i](a)},onClickDownloadSpine:function(e){var t=this.targetSpine.node.getComponent("spine_init");t.loadResources(function(){var n=e.target;n.opacity=255,n.active=!0,cc.tween(n).to(1,{opacity:0},{easing:"cubicOut"}).call(function(){n.active=!1,this._initRegionButton(),t.replaceAllRegion()}.bind(this)).start()}.bind(this))},_changeRegion:function(e){var t,n=this.targetSpine.findSlot(e).getAttachment(),i=e,a=this.changeSpriteFrames.find(function(e){return e.name==i});if(!a)return!1;t=this.createRegionBySpriteFrame(a),"function"==typeof n.setRegion?(n.setRegion(t),n.updateOffset()):(n.region=t,n.updateUVs()),this.node.getChildByName("changeRegion@"+e).active=!1,this.node.getChildByName("recoverRegion@"+e).active=!0},_recoverRegion:function(e){var t=this.targetSpine.findSlot(e).getAttachment(),n=this.originSpine.findSlot(e).getAttachment().region,i=this.createRegionByRegion(n);"function"==typeof t.setRegion?(t.setRegion(i),t.updateOffset()):(t.region=i,t.updateUVs()),cc.log("recoverRegion\uff1a",i),this.node.getChildByName("changeRegion@"+e).active=!0,this.node.getChildByName("recoverRegion@"+e).active=!1},_recoverAttachment:function(e){var t=this.targetSpine.findSlot(e),n=this.originSpine.findSlot(e).getAttachment();t.setAttachment(n),cc.log("recoverAttachment\uff1a",t.getAttachment())},update:function(){}}),cc._RF.pop()},{os:1}],spine_init:[function(e,t){"use strict";cc._RF.push(t,"6a8d34XhZ9Ji6PLp5X1bYCt","spine_init"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.skeleton=this.node.getComponent(sp.Skeleton);var e=this.skeleton.skeletonData.name;this.skinNames=Object.keys(this.skeleton.skeletonData.skeletonJson.skins),this.skinSlotNames=[],this.downloadPath="Texture/spine_textures/"+e,this.textureMap=new Map,this._defaultSpriteFrames=[],this._initTextureInfo(),this._initTextureMap()},start:function(){},_initTextureInfo:function(){var e=this;this.skinNames.forEach(function(t){var n=t,i=Object.keys(e.skeleton.skeletonData.skeletonJson.skins[n]);cc.log(i),e.skinSlotNames[n]=i}),cc.log("this.skinSlotNames:"),cc.log(this.skinSlotNames)},_initTextureMap:function(){var e=this;cc.resources.getDirWithPath(this.downloadPath,cc.SpriteFrame).map(function(e){return e.path}).forEach(function(t){var n="string"==typeof t?t.replace(e.downloadPath+"/",""):"",i=n.split("/"),a={name:i[i.length-1],region:e.skeleton.skeletonData._atlasCache.regions.find(function(e){return e.name==n})};e.textureMap.set(n,a)}),cc.log("textureMap\uff1a"),cc.log(this.textureMap)},_findSlotIndex:function(e){return this.skeleton.skeletonData._skeletonCache.findSlotIndex(e)},loadResources:function(e){this.startTime=new Date,cc.resources.loadDir(this.downloadPath,cc.SpriteFrame,function(t,n){this._defaultSpriteFrames=n,null!=e&&null!=e&&e();var i=(new Date-this.startTime)/1e3;cc.log("loadResources\u5e7e\u79d2\uff1a"+i)}.bind(this))},loadResources2:function(e){this.startTime=new Date,cc.resources.loadDir("Texture/test",cc.SpriteFrame,function(){null!=e&&null!=e&&e();var t=(new Date-this.startTime)/1e3;cc.log("loadResources2\u5e7e\u79d2\uff1a"+t)}.bind(this))},replaceAllRegion:function(){cc.log(this._defaultSpriteFrames),this.skeleton.skeletonData._skeletonCache.skins.forEach(function(e){cc.log("\u54ed\u963f\uff1a",this.skinSlotNames[e.name]),cc.log("skin\uff1a",e),this.skinSlotNames[e.name].forEach(function(t){var n=this._findSlotIndex(t);Object.values(e.attachments[n]).forEach(function(e){var t=this.textureMap.get(e.path).name,n=this.textureMap.get(e.path).region;cc.log("textureName:",t);var i=this.createRegion(this._defaultSpriteFrames.find(function(e){return e.name==t}),n);"function"==typeof e.setRegion?(e.setRegion(i),e.updateOffset()):(e.region=i,e.updateUVs())}.bind(this))}.bind(this))}.bind(this))},createRegion:function(e){var t=e.getTexture();cc.log("createRegion\uff1a",t);var n=new sp.SkeletonTexture({width:t.width,height:t.height});n.setRealTexture(t);var i=new sp.spine.TextureAtlasPage;i.name=t.name,i.uWrap=sp.spine.TextureWrap.ClampToEdge,i.vWrap=sp.spine.TextureWrap.ClampToEdge,i.texture=n,i.texture.setWraps(i.uWrap,i.vWrap),i.width=t.width,i.height=t.height;var a=new sp.spine.TextureAtlasRegion;return a.page=i,a.name=e.name,a.width=e._rect.width,a.height=e._rect.height,a.x=e._rect.x,a.y=e._rect.y,a.originalWidth=e._rect.width,a.originalHeight=e._rect.height,a.rotate=e._rotated,a.u=e.uv[0],a.v=e.uv[7],a.u2=e.uv[6],a.v2=e.uv[1],a.texture=n,a},replaceRegionTexture:function(){}}),cc._RF.pop()},{}]},{},["HelloWorld","spine_init"]);